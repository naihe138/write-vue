{"version":3,"file":"vue.js","sources":["../src/observer/array.js","../src/utils/index.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["let oldArrayProtoMethods = Array.prototype\n\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\n\nlet methods = ['push', 'pop', 'shift', 'unshift', 'reverse', 'sort', 'splice']\n\nmethods.forEach(method => {\n  arrayMethods[method] = function (...args) {\n    const result = oldArrayProtoMethods[method].apply(this, args);\n    const ob = this.__ob__;\n    let inserted = null;\n    switch(method) {\n      case 'push':\n      case 'unshift':\n        inserted = args\n        break\n      case 'splice':\n        inserted = args.slice(2)\n        break\n      default: \n        break\n    }\n    if (inserted) {\n      ob.observeArray(inserted)\n    }\n    return result\n  }\n})","\nexport const emptyObject = Object.freeze({})\n\nexport function isUndef (v) {\n  return v === undefined || v === null\n}\n\nexport function isDef (v) {\n  return v !== undefined && v !== null\n}\n\nexport function isTrue (v) {\n  return v === true\n}\n\nexport function isFalse (v) {\n  return v === false\n}\n\n/**\n * 是否是原始类型.\n */\nexport function isPrimitive (value) {\n  return (\n    typeof value === 'string' ||\n    typeof value === 'number' ||\n    // $flow-disable-line\n    typeof value === 'symbol' ||\n    typeof value === 'boolean'\n  )\n}\n\nexport function isObject (obj) {\n  return obj !== null && typeof obj === 'object'\n}\n\n\nconst _toString = Object.prototype.toString\n\nexport function toRawType (value){\n  return _toString.call(value).slice(8, -1)\n}\n\nexport function isPlainObject (obj){\n  return _toString.call(obj) === '[object Object]'\n}\n\nexport function isRegExp (v){\n  return _toString.call(v) === '[object RegExp]'\n}\n\nexport function isValidArrayIndex (val){\n  const n = parseFloat(String(val))\n  return n >= 0 && Math.floor(n) === n && isFinite(val)\n}\n\nexport function isPromise (val){\n  return (\n    isDef(val) &&\n    typeof val.then === 'function' &&\n    typeof val.catch === 'function'\n  )\n}\n\nexport function toString (val){\n  return val == null\n    ? ''\n    : Array.isArray(val) || (isPlainObject(val) && val.toString === _toString)\n      ? JSON.stringify(val, null, 2)\n      : String(val)\n}\n\nexport function toNumber (val) {\n  const n = parseFloat(val)\n  return isNaN(n) ? val : n\n}\n\n\nexport function makeMap (\n  str,\n  expectsLowerCase\n){\n  const map = Object.create(null)\n  const list = str.split(',')\n  for (let i = 0; i < list.length; i++) {\n    map[list[i]] = true\n  }\n  return expectsLowerCase\n    ? val => map[val.toLowerCase()]\n    : val => map[val]\n}\n\n/**\n * Check if a tag is a built-in tag.\n */\nexport const isBuiltInTag = makeMap('slot,component', true)\n\n/**\n * Check if an attribute is a reserved attribute.\n */\nexport const isReservedAttribute = makeMap('key,ref,slot,slot-scope,is')\n\n/**\n * Remove an item from an array.\n */\nexport function remove (arr, item) {\n  if (arr.length) {\n    const index = arr.indexOf(item)\n    if (index > -1) {\n      return arr.splice(index, 1)\n    }\n  }\n}\n\n/**\n * Check whether an object has the property.\n */\nconst hasOwnProperty = Object.prototype.hasOwnProperty\nexport function hasOwn (obj, key){\n  return hasOwnProperty.call(obj, key)\n}\n\n/**\n * Create a cached version of a pure function.\n */\nexport function cached (fn) {\n  const cache = Object.create(null)\n  return (function cachedFn (str) {\n    const hit = cache[str]\n    return hit || (cache[str] = fn(str))\n  })\n}\n\n/**\n * Camelize a hyphen-delimited string.\n */\nconst camelizeRE = /-(\\w)/g\nexport const camelize = cached((str)=> {\n  return str.replace(camelizeRE, (_, c) => c ? c.toUpperCase() : '')\n})\n\n/**\n * Capitalize a string.\n */\nexport const capitalize = cached((str)=> {\n  return str.charAt(0).toUpperCase() + str.slice(1)\n})\n\n/**\n * Hyphenate a camelCase string.\n */\nconst hyphenateRE = /\\B([A-Z])/g\nexport const hyphenate = cached((str)=> {\n  return str.replace(hyphenateRE, '-$1').toLowerCase()\n})\n\n/**\n * Simple bind polyfill for environments that do not support it,\n * e.g., PhantomJS 1.x. Technically, we don't need this anymore\n * since native bind is now performant enough in most browsers.\n * But removing it would mean breaking code that was able to run in\n * PhantomJS 1.x, so this must be kept for backward compatibility.\n */\n\n/* istanbul ignore next */\nfunction polyfillBind (fn, ctx) {\n  function boundFn (a) {\n    const l = arguments.length\n    return l\n      ? l > 1\n        ? fn.apply(ctx, arguments)\n        : fn.call(ctx, a)\n      : fn.call(ctx)\n  }\n\n  boundFn._length = fn.length\n  return boundFn\n}\n\nfunction nativeBind (fn, ctx) {\n  return fn.bind(ctx)\n}\n\nexport const bind = Function.prototype.bind\n  ? nativeBind\n  : polyfillBind\n\n/**\n * Convert an Array-like object to a real Array.\n */\nexport function toArray (list, start) {\n  start = start || 0\n  let i = list.length - start\n  const ret = new Array(i)\n  while (i--) {\n    ret[i] = list[i + start]\n  }\n  return ret\n}\n\n/**\n * Mix properties into target object.\n */\nexport function extend (to, _from) {\n  for (const key in _from) {\n    to[key] = _from[key]\n  }\n  return to\n}\n\n/**\n * Merge an Array of Objects into a single Object.\n */\nexport function toObject (arr) {\n  const res = {}\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i]) {\n      extend(res, arr[i])\n    }\n  }\n  return res\n}\n\n/* eslint-disable no-unused-vars */\n\n/**\n * Perform no operation.\n * Stubbing args to make Flow happy without leaving useless transpiled code\n * with ...rest (https://flow.org/blog/2017/05/07/Strict-Function-Call-Arity/).\n */\nexport function noop () {}\n\n/**\n * Always return false.\n */\nexport const no = () => false\n\n/* eslint-enable no-unused-vars */\n\n/**\n * Return the same value.\n */\nexport const identity = (_) => _\n\n/**\n * Generate a string containing static keys from compiler modules.\n */\nexport function genStaticKeys (modules){\n  return modules.reduce((keys, m) => {\n    return keys.concat(m.staticKeys || [])\n  }, []).join(',')\n}\n\n/**\n * Check if two values are loosely equal - that is,\n * if they are plain objects, do they have the same shape?\n */\nexport function looseEqual (a, b){\n  if (a === b) return true\n  const isObjectA = isObject(a)\n  const isObjectB = isObject(b)\n  if (isObjectA && isObjectB) {\n    try {\n      const isArrayA = Array.isArray(a)\n      const isArrayB = Array.isArray(b)\n      if (isArrayA && isArrayB) {\n        return a.length === b.length && a.every((e, i) => {\n          return looseEqual(e, b[i])\n        })\n      } else if (a instanceof Date && b instanceof Date) {\n        return a.getTime() === b.getTime()\n      } else if (!isArrayA && !isArrayB) {\n        const keysA = Object.keys(a)\n        const keysB = Object.keys(b)\n        return keysA.length === keysB.length && keysA.every(key => {\n          return looseEqual(a[key], b[key])\n        })\n      } else {\n        /* istanbul ignore next */\n        return false\n      }\n    } catch (e) {\n      /* istanbul ignore next */\n      return false\n    }\n  } else if (!isObjectA && !isObjectB) {\n    return String(a) === String(b)\n  } else {\n    return false\n  }\n}\n\n/**\n * Return the first index at which a loosely equal value can be\n * found in the array (if value is a plain object, the array must\n * contain an object of the same shape), or -1 if it is not present.\n */\nexport function looseIndexOf (arr, val) {\n  for (let i = 0; i < arr.length; i++) {\n    if (looseEqual(arr[i], val)) return i\n  }\n  return -1\n}\n\n/**\n * Ensure a function is called only once.\n */\nexport function once (fn) {\n  let called = false\n  return function () {\n    if (!called) {\n      called = true\n      fn.apply(this, arguments)\n    }\n  }\n}\n","import { arrayMethods } from './array'\nimport { hasOwn } from '../utils/index' \nclass Observer{\n  constructor(value) {\n    Object.defineProperty(value, '__ob__', {\n      enumerable: false,\n      configurable: false,\n      value: this\n    })\n    if (Array.isArray(value)) {\n      value.__proto__ = arrayMethods\n      this.observeArray(value)\n    } else {\n      this.walk(value)\n    }\n  }\n  walk(data) {\n    let keys = Object.keys(data);\n    for (let i = 0, len = keys.length; i < len; i++) {\n      let key = keys[i]\n      let value = data[key]\n      defineReactive(data, key, value)\n    }\n  }\n  observeArray(value) {\n    for (let i = 0, len = value.length; i < len; i++) {\n      observe(value[i])\n    }\n  }\n}\nfunction defineReactive(data, key, value) {\n  observe(value);\n  Object.defineProperty(data, key, {\n    get() {\n      return value\n    },\n    set(newValue) {\n      if (newValue == value) return\n      observe(newValue)\n      value = newValue\n    }\n  })\n}\nexport function observe(data) {\n  if (typeof data !== 'object' && data != null) {\n    return;\n  }\n  // 如果被监听过就返回监听过的对象\n  if (hasOwn(data, '__ob__') && data.__ob__ instanceof Observer) {\n    return data.__ob__\n  } else {\n    return new Observer(data)\n  }\n}","import { observe } from './observer/index' \nexport function initState(vm) {\n  const opts = vm.$options;\n  if (opts.props) {\n    initProps(vm);\n  }\n  if (opts.methods) {\n    initMethod(vm);\n  }\n  if (opts.data) {\n    initData(vm);\n  }\n  if (opts.computed) {\n    initComputed(vm);\n  }\n  if (opts.watch) {\n    initWatch(vm);\n  }\n}\n\nfunction initProps(vm) {}\n\nfunction initMethod(vm) {}\n\nfunction proxy(vm, source, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key]\n    },\n    set(newValue) {\n      return vm[source][key] = newValue\n    }\n  })\n}\n\nfunction initData(vm) {\n  let data = vm.$options.data;\n  data = vm._data = typeof data === 'function'\n    ? data.call(vm, vm)\n    : data || {};\n  // 数据代理\n  let keys = Object.keys(data);\n  let i = keys.length;\n  while(i--) {\n    proxy(vm, '_data', keys[i]);\n  }\n  observe(data);\n}\n\nfunction initComputed(vm) {}\n\nfunction initWatch(vm) {}\n\n","import { initState } from './state'\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    vm.$options = options\n    initState(vm)\n  }\n}","import { initMixin } from './init';\nfunction Vue(options) {\n  this._init(options)\n}\n\ninitMixin(Vue)\n\nexport default Vue\n"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","result","apply","ob","__ob__","inserted","slice","observeArray","emptyObject","freeze","makeMap","str","expectsLowerCase","map","list","split","i","length","val","toLowerCase","isBuiltInTag","isReservedAttribute","hasOwnProperty","hasOwn","obj","key","call","Observer","value","defineProperty","enumerable","configurable","isArray","__proto__","walk","data","keys","len","defineReactive","observe","get","set","newValue","initState","vm","opts","$options","props","initData","computed","watch","proxy","source","_data","initMixin","Vue","_init","options"],"mappings":"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"}